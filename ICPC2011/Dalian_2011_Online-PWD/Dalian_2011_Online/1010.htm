<html><head><meta name="keywords" content="HDOJ ACM ICPC OJ C C++ Pascal Java"><meta http-equiv="Content-Type" content="text/html; charset=GB2312"><link rel="stylesheet" href="files/global.css" type="text/css"><title>Problem - 1010</title></head><body><a name="top"></a><center>
<div id="contest_nav" align="center">
	<a href="http://acm.hdu.edu.cn/vip/dalian2011/" style="margin: 0pt;"><img src="files/conlogo.png" height="116" width="980"></a>
	<a href="http://acm.hdu.edu.cn/vip/dalian2011/">Home</a>
	<a href="http://acm.hdu.edu.cn/vip/notification.php?cid=367">Notification</a>
	<a href="http://acm.hdu.edu.cn/vip/contest_clalification.php?cid=367&amp;page=1">Clarification</a>
	<a href="http://acm.hdu.edu.cn/vip/contest_show.php?cid=367">Problems</a>
	<a href="http://acm.hdu.edu.cn/vip/contest_ranklist.php?cid=367">Ranklist</a>
	<a href="http://acm.hdu.edu.cn/vip/contest_status.php?cid=367">Status</a>
	<!--<a href="/vip/contest_statistic.php?cid=367">Statistics</a>-->
	<a style="color: gray;">Statistics</a>
		<a style="color: gray;">Print</a>
	</div>
<div style="width:980px;padding:0;margin:0"><h1 style="color:#1A5CC8;margin-top: 20px">Query on The Trees</h1><font face="Arial"><b><span style="font-size:12px;color:green">Time Limit: 10000/5000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 65768/65768 K (Java/Others)</span></b></font><br><br><div class="panel_title" align="left">Problem Description</div><div class="panel_content">We have met so many problems on the tree, so today we will have a query problem on a set of trees. <br>There
  are  N  nodes,  each  node  will  have  a  unique  weight  Wi.  We  
will  have  four  kinds  of operations on it and you should solve them 
efficiently. Wish you have fun! <br><br></div><div class="panel_bottom">&nbsp;</div><br><div class="panel_title" align="left">Input</div><div class="panel_content">There are multiple test cases in our dataset. <br>For
 each case, the first line contains only one integer N.(1  ¡Ü  N  ¡Ü  
300000) The next N©\1 lines each contains two integers x, y which means 
there is an edge between them. It also means we will give you one tree 
initially. <br>The next line will contains N integers which means the weight Wi of each node. (0  ¡Ü  Wi ¡Ü  3000) <br>The
 next line will contains an integer Q. (1  ¡Ü  Q  ¡Ü  300000) The next Q 
lines will start with an integer 1, 2, 3 or 4 means the kind of this 
operation. <br>1. Given two integer x, y, you should make a new edge 
between these two node x and y. So after this operation, two trees will 
be connected to a new one. <br>2. Given two integer x, y, you should 
find the tree in the tree set who contain node x, and you should make 
the node x be the root of this tree, and then you should cut the edge 
between node y and its parent. So after this operation, a tree will be 
separate into two parts. <br>3. Given three integer w, x, y, for the x, y and all nodes between the path from x to y, you should increase their weight by w. <br>4.
 Given two integer x, y, you should check the node weights on the path 
between x and y, and you should output the maximum weight on it. <br></div><div class="panel_bottom">&nbsp;</div><br><div class="panel_title" align="left">Output</div><div class="panel_content">For
 each query you should output the correct answer of it. If you find this
 query is an illegal operation, you should output ©\1. <br>You should output a blank line after each test case. </div><div class="panel_bottom">&nbsp;</div><br><div class="panel_title" align="left">Sample Input</div><div class="panel_content">
<pre><div style="font-family:Courier New,Courier,monospace;">5
1 2
2 4
2 5
1 3
1 2 3 4 5
6
4 2 3
2 1 2
4 2 3
1 3 5
3 2 1 4
4 1 4</div></pre></div><div class="panel_bottom">&nbsp;</div><br><div class="panel_title" align="left">Sample Output</div><div class="panel_content">
<pre><div style="font-family:Courier New,Courier,monospace;">3
-1
7

<div style="font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px"><div style="font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed"><i>Hint</i></div>
We define the illegal situation of different operations: 
In first operation: if node x and y belong to a same tree, we think it's illegal. 
In second operation: if x = y or x and y not belong to a same tree, we think it's illegal. 
In third operation: if x and y not belong to a same tree, we think it's illegal. 
In fourth operation: if x and y not belong to a same tree, we think it's illegal. 
</div></div></pre></div><div class="panel_bottom">&nbsp;</div><br><center style="font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8"><a href="http://acm.hdu.edu.cn/vip/contest_statistic.php?cid=367&amp;pid=1010">Statistic</a>&nbsp;|&nbsp;<a href="http://acm.hdu.edu.cn/vip/contest_submit.php?cid=367&amp;pid=1010">Submit</a>&nbsp;|&nbsp;<a href="http://acm.hdu.edu.cn/vip/contest_clalification.php?cid=367&amp;page=1">Clarifications</a>&nbsp;|&nbsp;<a href="http://acm.hdu.edu.cn/vip/contest_show.php?cid=367">Back</a></center><br></div>
<div id="contest_footer">
	<div class="footer_link" style="width:15%;float:left;line-height:67px"><a href="http://acm.hdu.edu.cn/">Home</a> | <a href="#top">Top</a></div>
	<div style="width:68%;float:left">
	Hangzhou Dianzi University Online Judge 3.0<br>
	Copyright &#169; 2005-2011 <a href="mailto:acm@hdu.edu.cn">HDU ACM Team</a>. All Rights Reserved.<br>
	<a href="http://acm.hdu.edu.cn/about_us/developer.php">Designer &amp; Developer </a> : <a>Wang Rongtao</a>&nbsp;<a>Lin Le</a>&nbsp;<a href="mailto:gjavac@gmail.com">GaoJie</a>&nbsp;<a href="mailto:gl8997@gmail.com">GanLu</a><br>
	<span class="pagerunstatus">Total 0.000424(s) query 27, Gzip enabled</span>	</div>
	<div class="footer_link" style="width:15%;float:right;line-height:67px">
		<a href="http://acm.hdu.edu.cn/admin">Administration</a>	
	</div>
</div></center>


</body></html>